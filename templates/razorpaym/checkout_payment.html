<h2>Payment</h2>
<p>Order ID: {{ order.id }}</p>
<p>Total Amount: â‚¹{{ order.total_amount }}</p>

<button id="rzp-button1">Pay with Razorpay</button>

<script src="https://checkout.razorpay.com/v1/checkout.js"></script>
<script>
var options = {
    "key": "{{ razorpay_key }}",
    "amount": "{{ razorpay_order.amount }}",
    "currency": "INR",
    "name": "My Shop",
    "description": "Order #{{ order.id }}",
    "order_id": "{{ razorpay_order.id }}",
    "handler": function (response){
        // Send payment response to backend
        fetch("{% url 'razorpaym:payment_success' %}", {
            method: "POST",
            headers: {
                "X-CSRFToken": "{{ csrf_token }}",
                "Content-Type": "application/x-www-form-urlencoded"
            },
            body: new URLSearchParams(response).toString()
        }).then(res => res.text()).then(data => {
            document.body.innerHTML = data;
        })
    },
    "prefill": {
        "name": "{{ order.user.username }}",
        "email": "{{ order.user.email }}",
        "contact": "{{ order.user.profile.phone_number }}"
    },
    "theme": {
        "color": "#3399cc"
    }
};
var rzp1 = new Razorpay(options);
document.getElementById('rzp-button1').onclick = function(e){
    rzp1.open();
    e.preventDefault();
}
</script>
